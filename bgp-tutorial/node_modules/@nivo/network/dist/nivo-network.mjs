import{memo as e,useState as n,useEffect as i,useMemo as o,useCallback as t,createElement as r,forwardRef as d,Fragment as a,useRef as c}from"react";import{useMotionConfig as l,Container as s,useDimensions as u,SvgWrapper as v,ResponsiveWrapper as f,getRelativeCursor as h,getDistance as k,mergeRefs as p}from"@nivo/core";import{animated as g,to as m,useTransition as y}from"@react-spring/web";import{jsx as C,Fragment as z}from"react/jsx-runtime";import{BasicTooltip as M,useTooltip as x}from"@nivo/tooltip";import{forceSimulation as b,forceLink as I,forceManyBody as S,forceCenter as N}from"d3-force";import{useTheme as W}from"@nivo/theming";import{useInheritedColor as B}from"@nivo/colors";import{useAnnotations as w,Annotation as R,useComputedAnnotations as T,renderAnnotationsToCanvas as A}from"@nivo/annotations";function L(){return L=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},L.apply(null,arguments)}function D(e,n){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==n.indexOf(o))continue;i[o]=e[o]}return i}var E=e((function(e){var n=e.node,i=e.animated,o=e.onClick,t=e.onMouseEnter,r=e.onMouseMove,d=e.onMouseLeave;return C(g.circle,{"data-testid":"node."+n.id,transform:m([i.x,i.y,i.scale],(function(e,n,i){return"translate("+e+","+n+") scale("+i+")"})),r:m([i.size],(function(e){return e/2})),fill:i.color,strokeWidth:i.borderWidth,stroke:i.borderColor,opacity:i.opacity,onClick:o?function(e){return o(n,e)}:void 0,onMouseEnter:t?function(e){return t(n,e)}:void 0,onMouseMove:r?function(e){return r(n,e)}:void 0,onMouseLeave:d?function(e){return d(n,e)}:void 0})})),H=e((function(e){var n=e.link,i=e.animated,o=e.blendMode;return C(g.line,{"data-testid":"link."+n.id,stroke:i.color,style:{mixBlendMode:o},strokeWidth:n.thickness,strokeLinecap:"round",opacity:i.opacity,x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2})})),P={layers:["links","nodes","annotations"],linkDistance:30,centeringStrength:1,repulsivity:10,distanceMin:1,distanceMax:1/0,iterations:120,nodeSize:12,activeNodeSize:18,inactiveNodeSize:8,nodeColor:"#000000",nodeBorderWidth:0,nodeBorderColor:{from:"color"},linkThickness:1,linkColor:{from:"source.color"},isInteractive:!0,defaultActiveNodeIds:[],nodeTooltip:function(e){var n=e.node;return C(M,{id:n.id,enableChip:!0,color:n.color})},annotations:[],animate:!0,motionConfig:"gentle",role:"img"},O=L({},P,{nodeComponent:E,linkComponent:H,linkBlendMode:"normal"}),j=L({},P,{renderNode:function(e,n){e.fillStyle=n.color,e.beginPath(),e.arc(n.x,n.y,n.size/2,0,2*Math.PI),e.fill(),n.borderWidth>0&&(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.stroke())},renderLink:function(e,n){e.strokeStyle=n.color,e.lineWidth=n.thickness,e.beginPath(),e.moveTo(n.source.x,n.source.y),e.lineTo(n.target.x,n.target.y),e.stroke()},pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),F=["index"],q=function(e){return o((function(){return"function"==typeof e?e:function(){return e}}),[e])},G=function(e){var r=e.center,d=e.nodes,a=e.links,c=e.linkDistance,l=void 0===c?P.linkDistance:c,s=e.centeringStrength,u=void 0===s?P.centeringStrength:s,v=e.repulsivity,f=void 0===v?P.repulsivity:v,h=e.distanceMin,k=void 0===h?P.distanceMin:h,p=e.distanceMax,g=void 0===p?P.distanceMax:p,m=e.iterations,y=void 0===m?P.iterations:m,C=e.nodeSize,z=void 0===C?P.nodeSize:C,M=e.activeNodeSize,x=void 0===M?P.activeNodeSize:M,w=e.inactiveNodeSize,R=void 0===w?P.inactiveNodeSize:w,T=e.nodeColor,A=void 0===T?P.nodeColor:T,E=e.nodeBorderWidth,H=void 0===E?P.nodeBorderWidth:E,O=e.nodeBorderColor,j=void 0===O?P.nodeBorderColor:O,G=e.linkThickness,J=void 0===G?P.linkThickness:G,K=e.linkColor,Q=void 0===K?P.linkColor:K,U=e.isInteractive,V=void 0===U?P.isInteractive:U,X=e.defaultActiveNodeIds,Y=void 0===X?P.defaultActiveNodeIds:X,Z=n(null),$=Z[0],_=Z[1],ee=n(null),ne=ee[0],ie=ee[1],oe=function(e){var n=e.linkDistance,i=e.centeringStrength,t=e.repulsivity,r=e.distanceMin,d=e.distanceMax,a=e.center,c=q(n),l=a[0],s=a[1];return o((function(){return{link:I().distance((function(e){return c(e.data)})).strength(i),charge:S().strength(-t).distanceMin(r).distanceMax(d),center:N(l,s)}}),[c,i,t,r,d,l,s])}({linkDistance:l,centeringStrength:u,repulsivity:f,distanceMin:k,distanceMax:g,center:r});i((function(){var e=d.map((function(e){return{id:e.id,data:L({},e),index:0,x:0,y:0,vx:0,vy:0}})),n=a.map((function(n){return{data:L({},n),index:0,source:e.find((function(e){return e.id===n.source})),target:e.find((function(e){return e.id===n.target}))}})),i=b(e).force("link",oe.link.links(n)).force("charge",oe.charge).force("center",oe.center).stop();return i.tick(y),_(e),ie(n),function(){i.stop()}}),[d,a,oe,y,_,ie]);var te=n(Y),re=te[0],de=te[1],ae=function(e){var n=e.size,i=e.activeSize,o=e.inactiveSize,r=e.color,d=e.borderWidth,a=e.borderColor,c=e.isInteractive,l=e.activeNodeIds,s=W(),u=q(n),v=q(r),f=q(d),h=B(a,s),k=t((function(e){var n=v(e.data);return{size:u(e.data),color:n,borderWidth:f(e.data),borderColor:h(L({},e,{color:n}))}}),[u,v,f,h]),p=q(i),g=t((function(e){var n=v(e.data);return{size:p(e.data),color:n,borderWidth:f(e.data),borderColor:h(L({},e,{color:n}))}}),[p,v,f,h]),m=q(o),y=t((function(e){var n=v(e.data);return{size:m(e.data),color:n,borderWidth:f(e.data),borderColor:h(L({},e,{color:n}))}}),[m,v,f,h]);return t((function(e){return c&&0!==l.length?l.includes(e.id)?g(e):y(e):k(e)}),[k,g,y,c,l])}({size:z,activeSize:x,inactiveSize:R,color:A,borderWidth:H,borderColor:j,isInteractive:V,activeNodeIds:re}),ce=o((function(){return null===$?null:$.map((function(e){return L({},e,ae(e))}))}),[$,ae]),le=W(),se=q(J),ue=B(Q,le),ve=o((function(){return null===ne||null===ce?null:ne.map((function(e){var n=e.index,i=D(e,F),o={id:i.source.id+"."+i.target.id,data:i.data,index:n,source:ce.find((function(e){return e.id===i.source.id})),target:ce.find((function(e){return e.id===i.target.id}))};return L({},o,{thickness:se(o),color:ue(o)})}))}),[ne,ce,se,ue]);return{nodes:ce,links:ve,activeNodeIds:re,setActiveNodeIds:de}},J=function(e){return{x:e.x,y:e.y}},K=function(e){return{size:e.size,width:e.size,height:e.size}},Q=function(e,n){return w({data:e,annotations:n,getPosition:J,getDimensions:K})},U=function(e){var n=e.links,i=e.linkComponent,t=e.blendMode,d=l(),a=d.animate,c=d.config,s=o((function(){return[function(e){return{x1:e.source.x,y1:e.source.y,x2:e.source.x,y2:e.source.y,color:e.color,opacity:0}},function(e){return{x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y,color:e.color,opacity:1}}]}),[]),u=s[0],v=s[1],f=y(n,{keys:function(e){return e.id},initial:v,from:u,enter:v,update:v,expires:!0,config:c,immediate:!a});return C(z,{children:f((function(e,n){return r(i,{key:n.id,link:n,animated:e,blendMode:t})}))})},V=function(e){var n=e.nodes,i=e.nodeComponent,d=e.onMouseEnter,a=e.onMouseMove,c=e.onMouseLeave,s=e.onClick,u=e.tooltip,v=e.setActiveNodeIds,f=e.isInteractive,h=l(),k=h.animate,p=h.config,g=o((function(){return[function(e){return{x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:e.borderWidth,borderColor:e.borderColor,scale:0,opacity:0}},function(e){return{x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:e.borderWidth,borderColor:e.borderColor,scale:1,opacity:1}},function(e){return{x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:e.borderWidth,borderColor:e.borderColor,scale:0,opacity:0}}]}),[]),m=g[0],M=g[1],b=g[2],I=y(n,{keys:function(e){return e.id},initial:M,from:m,enter:M,update:M,leave:b,config:p,immediate:!k}),S=x(),N=S.showTooltipFromEvent,W=S.hideTooltip,B=t((function(e,n){N(r(u,{node:e}),n),v([e.id]),null==d||d(e,n)}),[N,u,v,d]),w=t((function(e,n){N(r(u,{node:e}),n),null==a||a(e,n)}),[N,u,a]),R=t((function(e,n){W(),v([]),null==c||c(e,n)}),[W,v,c]);return C(z,{children:I((function(e,n){return r(i,{key:n.id,node:n,animated:e,onMouseEnter:f?B:void 0,onMouseMove:f?w:void 0,onMouseLeave:f?R:void 0,onClick:f?s:void 0})}))})},X=function(e){var n=e.nodes,i=e.annotations,o=Q(n,i);return C(z,{children:o.map((function(e,n){return C(R,L({},e),n)}))})},Y=["isInteractive","animate","motionConfig","theme","renderWrapper"],Z=function(e){var n=e.width,i=e.height,t=e.margin,d=e.data,c=d.nodes,l=d.links,s=e.linkDistance,f=void 0===s?O.linkDistance:s,h=e.centeringStrength,k=void 0===h?O.centeringStrength:h,p=e.repulsivity,g=void 0===p?O.repulsivity:p,m=e.distanceMin,y=void 0===m?O.distanceMin:m,z=e.distanceMax,M=void 0===z?O.distanceMax:z,x=e.iterations,b=void 0===x?O.iterations:x,I=e.layers,S=void 0===I?O.layers:I,N=e.nodeComponent,W=void 0===N?O.nodeComponent:N,B=e.nodeSize,w=void 0===B?O.nodeSize:B,R=e.activeNodeSize,T=void 0===R?O.activeNodeSize:R,A=e.inactiveNodeSize,L=void 0===A?O.inactiveNodeSize:A,D=e.nodeColor,E=void 0===D?O.nodeColor:D,H=e.nodeBorderWidth,P=void 0===H?O.nodeBorderWidth:H,j=e.nodeBorderColor,F=void 0===j?O.nodeBorderColor:j,q=e.linkComponent,J=void 0===q?O.linkComponent:q,K=e.linkThickness,Q=void 0===K?O.linkThickness:K,Y=e.linkColor,Z=void 0===Y?O.linkColor:Y,$=e.linkBlendMode,_=void 0===$?O.linkBlendMode:$,ee=e.annotations,ne=void 0===ee?O.annotations:ee,ie=e.isInteractive,oe=void 0===ie?O.isInteractive:ie,te=e.defaultActiveNodeIds,re=void 0===te?O.defaultActiveNodeIds:te,de=e.nodeTooltip,ae=void 0===de?O.nodeTooltip:de,ce=e.onMouseEnter,le=e.onMouseMove,se=e.onMouseLeave,ue=e.onClick,ve=e.role,fe=void 0===ve?O.role:ve,he=e.ariaLabel,ke=e.ariaLabelledBy,pe=e.ariaDescribedBy,ge=e.forwardedRef,me=u(n,i,t),ye=me.margin,Ce=me.innerWidth,ze=me.innerHeight,Me=me.outerWidth,xe=me.outerHeight,be=G({center:[Ce/2,ze/2],nodes:c,links:l,linkDistance:f,centeringStrength:k,repulsivity:g,distanceMin:y,distanceMax:M,iterations:b,nodeSize:w,activeNodeSize:T,inactiveNodeSize:L,nodeColor:E,nodeBorderWidth:P,nodeBorderColor:F,linkThickness:Q,linkColor:Z,isInteractive:oe,defaultActiveNodeIds:re}),Ie=be.nodes,Se=be.links,Ne=be.activeNodeIds,We=be.setActiveNodeIds,Be={links:null,nodes:null,annotations:null};S.includes("links")&&null!==Se&&(Be.links=C(U,{links:Se,linkComponent:J,blendMode:_},"links")),S.includes("nodes")&&null!==Ie&&(Be.nodes=C(V,{nodes:Ie,nodeComponent:W,onMouseEnter:ce,onMouseMove:le,onMouseLeave:se,onClick:ue,tooltip:ae,setActiveNodeIds:We,isInteractive:oe},"nodes")),S.includes("annotations")&&null!==Ie&&(Be.annotations=C(X,{nodes:Ie,annotations:ne},"annotations"));var we=o((function(){return{nodes:Ie||[],links:Se||[],activeNodeIds:Ne,setActiveNodeIds:We}}),[Ie,Se,Ne,We]);return C(v,{width:Me,height:xe,margin:ye,role:fe,ariaLabel:he,ariaLabelledBy:ke,ariaDescribedBy:pe,ref:ge,children:S.map((function(e,n){var i;return"function"==typeof e?C(a,{children:r(e,we)},n):null!=(i=null==Be?void 0:Be[e])?i:null}))})},$=d((function(e,n){var i=e.isInteractive,o=void 0===i?O.isInteractive:i,t=e.animate,r=void 0===t?O.animate:t,d=e.motionConfig,a=void 0===d?O.motionConfig:d,c=e.theme,l=e.renderWrapper,u=D(e,Y);return C(s,{animate:r,isInteractive:o,motionConfig:a,renderWrapper:l,theme:c,children:C(Z,L({},u,{isInteractive:o,forwardedRef:n}))})})),_=["defaultWidth","defaultHeight","onResize","debounceResize"],ee=d((function(e,n){var i=e.defaultWidth,o=e.defaultHeight,t=e.onResize,r=e.debounceResize,d=D(e,_);return C(f,{defaultWidth:i,defaultHeight:o,onResize:t,debounceResize:r,children:function(e){var i=e.width,o=e.height;return C($,L({},d,{width:i,height:o,ref:n}))}})})),ne=["theme","isInteractive","animate","motionConfig","renderWrapper"],ie=function(e){var n=e.width,d=e.height,a=e.margin,l=e.pixelRatio,s=void 0===l?j.pixelRatio:l,v=e.data,f=v.nodes,g=v.links,m=e.linkDistance,y=void 0===m?j.linkDistance:m,z=e.centeringStrength,M=void 0===z?j.centeringStrength:z,b=e.repulsivity,I=void 0===b?j.repulsivity:b,S=e.distanceMin,N=void 0===S?j.distanceMin:S,B=e.distanceMax,w=void 0===B?j.distanceMax:B,R=e.iterations,L=void 0===R?j.iterations:R,D=e.layers,E=void 0===D?j.layers:D,H=e.renderNode,P=void 0===H?j.renderNode:H,O=e.nodeSize,F=void 0===O?j.nodeSize:O,q=e.activeNodeSize,J=void 0===q?j.activeNodeSize:q,K=e.inactiveNodeSize,U=void 0===K?j.inactiveNodeSize:K,V=e.nodeColor,X=void 0===V?j.nodeColor:V,Y=e.nodeBorderWidth,Z=void 0===Y?j.nodeBorderWidth:Y,$=e.nodeBorderColor,_=void 0===$?j.nodeBorderColor:$,ee=e.renderLink,ne=void 0===ee?j.renderLink:ee,ie=e.linkThickness,oe=void 0===ie?j.linkThickness:ie,te=e.linkColor,re=void 0===te?j.linkColor:te,de=e.annotations,ae=void 0===de?j.annotations:de,ce=e.isInteractive,le=void 0===ce?j.isInteractive:ce,se=e.defaultActiveNodeIds,ue=void 0===se?j.defaultActiveNodeIds:se,ve=e.nodeTooltip,fe=void 0===ve?j.nodeTooltip:ve,he=e.onClick,ke=e.role,pe=e.forwardedRef,ge=c(null),me=u(n,d,a),ye=me.margin,Ce=me.innerWidth,ze=me.innerHeight,Me=me.outerWidth,xe=me.outerHeight,be=G({center:[Ce/2,ze/2],nodes:f,links:g,linkDistance:y,centeringStrength:M,repulsivity:I,distanceMin:N,distanceMax:w,iterations:L,nodeSize:F,activeNodeSize:J,inactiveNodeSize:U,nodeColor:X,nodeBorderWidth:Z,nodeBorderColor:_,linkThickness:oe,linkColor:re,isInteractive:le,defaultActiveNodeIds:ue}),Ie=be.nodes,Se=be.links,Ne=be.activeNodeIds,We=be.setActiveNodeIds,Be=Q(Ie,ae),we=T({annotations:Be}),Re=o((function(){return{nodes:Ie||[],links:Se||[],activeNodeIds:Ne,setActiveNodeIds:We}}),[Ie,Se,Ne,We]),Te=W();i((function(){if(null!==ge.current){ge.current.width=Me*s,ge.current.height=xe*s;var e=ge.current.getContext("2d");e.scale(s,s),e.fillStyle=Te.background,e.fillRect(0,0,Me,xe),e.translate(ye.left,ye.top),E.forEach((function(n){"links"===n&&null!==Se?Se.forEach((function(n){return ne(e,n)})):"nodes"===n&&null!==Ie?Ie.forEach((function(n){return P(e,n)})):"annotations"===n?A(e,{annotations:we,theme:Te}):"function"==typeof n&&null!==Ie&&null!==Se&&n(e,Re)}))}}),[ge,Me,xe,ye.left,ye.top,s,E,Te,Ie,Se,P,ne,we,Re]);var Ae=t((function(e){if(ge.current&&null!==Ie){var n=h(ge.current,e),i=n[0],o=n[1];return Ie.find((function(e){return k(e.x,e.y,i-ye.left,o-ye.top)<=e.size/2}))}}),[ge,ye,Ie]),Le=x(),De=Le.showTooltipFromEvent,Ee=Le.hideTooltip,He=t((function(e){var n=Ae(e);n?(De(r(fe,{node:n}),e),We([n.id])):(Ee(),We([]))}),[Ae,De,fe,Ee,We]),Pe=t((function(){Ee(),We([])}),[Ee,We]),Oe=t((function(e){if(he){var n=Ae(e);n&&he(n,e)}}),[Ae,he]);return C("canvas",{ref:p(ge,pe),width:Me*s,height:xe*s,style:{width:Me,height:xe,cursor:le?"auto":"normal"},onClick:le?Oe:void 0,onMouseEnter:le?He:void 0,onMouseLeave:le?Pe:void 0,onMouseMove:le?He:void 0,role:ke})},oe=d((function(e,n){var i=e.theme,o=e.isInteractive,t=void 0===o?j.isInteractive:o,r=e.animate,d=void 0===r?j.animate:r,a=e.motionConfig,c=void 0===a?j.motionConfig:a,l=e.renderWrapper,u=D(e,ne);return C(s,{isInteractive:t,animate:d,motionConfig:c,theme:i,renderWrapper:l,children:C(ie,L({},u,{isInteractive:t,forwardedRef:n}))})})),te=["defaultWidth","defaultHeight","onResize","debounceResize"],re=d((function(e,n){var i=e.defaultWidth,o=e.defaultHeight,t=e.onResize,r=e.debounceResize,d=D(e,te);return C(f,{defaultWidth:i,defaultHeight:o,onResize:t,debounceResize:r,children:function(e){var i=e.width,o=e.height;return C(oe,L({},d,{width:i,height:o,ref:n}))}})}));export{$ as Network,oe as NetworkCanvas,ee as ResponsiveNetwork,re as ResponsiveNetworkCanvas,j as canvasDefaultProps,P as commonDefaultProps,O as svgDefaultProps,G as useNetwork,Q as useNodeAnnotations};
//# sourceMappingURL=nivo-network.mjs.map
